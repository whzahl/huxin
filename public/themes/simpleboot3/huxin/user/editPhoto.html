<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <!--H5页面窗口自动调整到设备宽度，并禁止用户缩放页面-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!--当网站添加到主屏幕快速启动方式，可隐藏地址栏，仅针对ios的safari ios7.0版本以后，safari上已看不到效果-->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <!--将网站添加到主屏幕快速启动方式，仅针对ios的safari顶端状态条的样式-->
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <!--忽略将页面中的数字识别为电话号码 忽略Android平台中对邮箱地址的识别-->
    <meta name="format-detection" content="telphone=no, email=no" />
    <title>修改照片_互信网</title>
    <link href="__TMPL__/huxin/static/common/bootstrap.min.css" rel="stylesheet">
    <link href="__TMPL__/huxin/static/common/reset.css" rel="stylesheet">
    <link href="__TMPL__/huxin/static/common/main.css" rel="stylesheet">
    <script src="__TMPL__/huxin/static/scripts/jquery.min.js"></script>
    <script type="text/javascript" src="__TMPL__/huxin/static/js/jquery.flexslider-min.js"></script>
    <script type="text/javascript" src="__TMPL__/huxin/static/js/complex.js"></script>
    
</head>

<body>
<header class="header">
<div>
    <div class="top-container" style="background:#116fec; color:#FFF;">
        <span class="left""><a href="javascript:history.back()">&nbsp;</a></span>修改头像<span class="right"></span>
    </div>
</div>
</header>
<div class="wrap-page">
<form method="post" action="{:url('user/editPhoto')}" enctype="multipart/form-data">
<div class="list-container">
    <ul class="list">
        <li class="item item-input">

        </li>
        <li class="item item-input">
            <div id="sss" style="height: 100px; text-align:center; margin:0 auto">
                <if condition="$photo.photo eq ''">
                    <img src="__TMPL__/huxin/static/images/default.jpg" class="ml50 mt20" id="img0" style="width:100px; heigth:100px; border:3px dashed #eee;">
                </if>
                 <if condition="$photo.photo neq ''">
                    <img src="__ROOT__/.{$photo.photo}" class="ml50 mt20" id="img0" style="width:100px; heigth:100px; border:3px dashed #eee;">
                </if>
                <div style="z-index:100; margin:-97px 0px 10px 0px; opacity: 0;">
                <a href=" " class="tc acc_scicon"></a>
                <input class="form-control mt20" type="file" name="image" value="" style="width:100px; padding-top:70px;" id="file0"/>
                </div>
            </div>
        </li>
    </ul>
    <ul>
        <li class="item item-noline"><button class="btn btn-block btn-green">确定</button></li>
    </ul>
</div>
<form>
    <script type="text/javascript">    
            $(function() { 
                $("#file0").change(function() {
                    if (this.files && this.files[0]) {
                        var objUrl = getObjectURL(this.files[0]);
                        console.log("objUrl = " + objUrl);
                        if (objUrl) {
                            $("#img0").attr("src", objUrl);
                            $("#file0").click(function(e) {
                                $("#img0").attr("src", objUrl);
                            });
                        } else {
                            //IE下，使用滤镜
                            this.select();
                            var imgSrc = document.selection.createRange().text;
                            var localImagId = document.getElementById("sss");
                            //图片异常的捕捉，防止用户修改后缀来伪造图片
                            try {
                                preload.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src = data;
                            } catch (e) {
                                this._error("filter error");
                                return;
                            }
                            this.img.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod='scale',src=\"" + data + "\")";
                        }
                    }
                });
                //建立一個可存取到該file的url
                function getObjectURL(file) {
                    var url = null;
                    if (window.createObjectURL != undefined) { // basic
                        url = window.createObjectURL(file);
                    } else if (window.URL != undefined) { // mozilla(firefox)
                        url = window.URL.createObjectURL(file);
                    } else if (window.webkitURL != undefined) { // webkit or chrome
                        url = window.webkitURL.createObjectURL(file);
                    }
                    return url;
                }
            })
        </script>
<include file="huxin@footer"/>
</body>
</html>
